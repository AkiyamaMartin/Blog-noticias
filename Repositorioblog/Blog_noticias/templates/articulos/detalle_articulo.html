{% extends 'base.html' %}
{% load static %}

{% block content %}

        <!-- inicio modulo
        ================================================== -->

<div class="s-content content">
    <main class="row content__page">
            <article class="column large-full entry format-standard">

                <div class="media-wrap entry__media">
                    <div class="entry__post-thumb">
                        {# Imagen principal del artículo  misma que home#}
                        <img src="{{ articulo.imagen.url }}" alt="{{ articulo.titulo }}">
                    </div>
                </div>

                <div class="content__page-header entry__header">
                    
                    <h1 class="display-1 entry__title">
                        {{ articulo.titulo }}
                    </h1>
                    <ul class="entry__header-meta">
                        {# Autor del artículo - Comentado por ahora #}
                        {# <li class="author">Por <a href="{% url 'articulos:path_perfil_autor' articulo.autor.username %}">{{ articulo.autor.get_full_name|default:articulo.autor.username }}</a></li> #}
                        
                        
                        <li class="date">{{ articulo.creado|date:"d M Y" }}</li>
                        
                        
                        <li class="cat-links">
                            <a href="{% url 'articulos:path_lista_articulos' %}">Cultura</a>
                            {% if articulo.categoria %}
                                <a href="#0">{{ articulo.categoria.nombre }}</a> 
                            {% endif %}
                        </li>
                    </ul>
                    
                                                    
                                                    
                    {% if user.is_staff %}                                
                    <ul class="entry__header-meta">
                        
                        <li>
                            
                            <a href="{% url 'articulos:path_editar_articulo' articulo_slug=articulo.slug %}" class="btn full-width">Editar Artículo</a>
                            
                        </li>
                        <li>
                            
                            <a href="{% url 'articulos:path_borrar_articulo' articulo_slug=articulo.slug %}" class="btn btn--primary full-width" >Eliminar Artículo</a>
                            
                        </li>
                        
                    </ul>
                    
                </div> <div class="entry__content">
                    {% endif %}
                    
                    <p class="lead drop-cap">
                        {{ articulo.contenido|safe }} <!-- el safe para el richtextfield -->
                    </p>
                    
                    
                </div> 
                <div class="entry__related">
                    <h3 class="h2">Artículos Relacionados</h3>

                    <ul class="related">
                        {# Artículo Relacionado 1 (Estático) #}
                        <li class="related__item">
                            <a href="#0" class="related__link"> {# Enlace estático por ahora #}
                                <img src="https://via.placeholder.com/600x400?text=Articulo+Relacionado+1" alt="Artículo Relacionado 1"> {# Imagen de placeholder #}
                            </a>
                            <h5 class="related__post-title">Título de Artículo Relacionado Estático 1.</h5>
                        </li>
                        {# Artículo Relacionado 2 (Estático) #}
                        <li class="related__item">
                            <a href="#0" class="related__link"> {# Enlace estático por ahora #}
                                <img src="https://via.placeholder.com/600x400?text=Articulo+Relacionado+2" alt="Artículo Relacionado 2"> {# Imagen de placeholder #}
                            </a>
                            <h5 class="related__post-title">Título de Artículo Relacionado Estático 2.</h5>
                        </li>
                        
                    </ul>
                </div>
            </article> {# Sección de comentarios #}
        <div class="comments-wrap">

            <div id="comments" class="column large-12">

                <h3 class="h2">{{ comentarios|length }} Comentario{% if comentarios|length != 1 %}s{% endif %}</h3> 
                
                <ol class="commentlist">
                    {% if comentarios %}
                        {% for comentario in comentarios %}
                            <li class="depth-1 comment">
                                

                                <div class="comment__content">
                                    <div class="comment__info">
                                        <div class="comment__author">{{ comentario.autor.username }}</div> 
                                        <div class="comment__meta">
                                            <div class="comment__time">{{ comentario.creado|date:"d M Y" }}</div> 
                                            <div class="comment__reply">
                                                {% if user.is_authenticated%}
                                                    <p>
                                                        {% if user == comentario.autor %}

                                                            <a href="{% url 'comentarios:path_edit_comentario' articulo_slug=articulo.slug comentario_id=comentario.id %}">Editar</a>
                                                        
                                                        {% endif %}
                                                            <br>
                                                        {% if user == comentario.autor or user.is_staff %}
                                                            
                                                            <a class="comment-reply-link" href="{% url 'comentarios:path_delete_comentario'  articulo_slug=articulo.slug comentario_id=comentario.id %}">Eliminar</a>

                                                        {% endif %}    
                                                    </p>
                                                   
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="comment__text">
                                        <p>{{ comentario.contenido|linebreaksbr }}</p> 
                                    </div>
                                </div>
                            
                            </li>
                        {% endfor %}
                    {% else %}
                        <p>Este artículo aún no tiene comentarios.</p>
                    {% endif %}
                </ol>
            </div>
            <div class="column large-12 comment-respond">
                <div id="respond">
                        <h3 class="h5">Añadir Comentario <span>Tu dirección de correo no será publicada</span></h3>
                
                        {% if user.is_authenticated %}
                            <form name="contactForm" id="contactForm" method="post" action="{% url 'comentarios:path_add_comentario' articulo_slug=articulo.slug %}" autocomplete="off">
                                {% csrf_token %} 
                                <fieldset>
                                    <div class="message form-field">
                                        {{ form_comentario.contenido.label_tag }} 
                                        {{ form_comentario.contenido }} 
                                        {% if form_comentario.contenido.errors %}
                                            <ul class="errorlist">
                                            {% for error in form_comentario.contenido.errors %}
                                                    <li>{{ error }}</li>
                                                {% endfor %}
                                            </ul>
                                        {% endif %}
                                    </div>
                                    <input name="submit" id="submit" class="btn btn--primary btn-wide btn--large full-width" value="Añadir Comentario" type="submit">
                                </fieldset>
                            </form>
                        {% else %}
                            <p>Debes <a href="{% url 'usuarios:path_login' %}">iniciar sesión</a> para comentar.</p>
                        {% endif %}
                </div>
            </div>
                        
        </div>
    </main>
</div> 



{% endblock content %}